[исходник](https://doc.qt.io/qt-6/qttestlib-tutorial1-example.html)

# Глава 1: Написание unit-теста

Как написать unit-тест.

В этой первой главе мы увидим как написать простой unit-тест и как его выполнить.

Написание теста
***

Предположим, что вы хотите протестировать поведение нашего класса QString. Во-первых, вам нужен класс, который содержит функции теста. Этот класс должен наследоваться от класса QObject:

~~~
#include <QtTest>

class TestQString: public QObject
{
    Q_OBJECT
private slots:
    void toUpper();
};
~~~

>Внимание: Вам необходимо включить заголовочный файл QTest и объявить тестовые функции как приватные слоты, чтобы тестовые библиотеки нашли их и выполнили.

Затем вам необходимо реализовать сами тестовые функции. Реализация будет выглядет примерно так:

~~~
void TestQString::toUpper()
{
    QString str = "Hello";
    QVERIFY(str.toUpper() == "HELLO");
}
~~~

Макрос QVERIFY() вычисляет выражение, переданное ему в качестве аргумента. Если выражение истинно, то выполнение тестовой функции продолжается. В противном случае, сообщение, описывающее ошибку, добаляется в журнал тестирования и тестовая функция останавливается.

Если вам необходимо больше данных в тестовом журнале, то вам лучше использовать макро QCOMPARE():

~~~
void TestQString::toUpper()
{
    QString str = "Hello";
    QCOMPARE(str.toUpper(), QString("HELLO"));
}
~~~

Если строки не равны, содержимое обоих строк добавляются в журнал тестов, чтобы сразу было видно, что сравнение не удалось.

Наконец, чтобы сделать наш тест отдельным исполняемым файлом нужно добавить следующие две строки:

~~~
QTEST_MAIN(TestQString)
~~~

Макрос QTEST_MAIN() раворачивается в обычный метод main(), который запускает все тестовые функции. Обратите внимание, если объявления и реализация наших тестов находятся в .cpp файлах, нам также надо будет включить сгенерированный moc файл, чтобы работала интроспекция Qt.

~~~
/myTestDirectory$ qmake -project "QT += testlib"
/myTestDirectory$ qmake
/myTestDirectory$ make
~~~

> Внимание, если вы используете Windows, замените make на nmake или используйте инструмент сборки, который используете обычно.

Запуская полученный исполняемый файл, вы получите следующий вывод:

~~~
********* Start testing of TestQString *********
Config: Using QtTest library %VERSION%, Qt %VERSION%
PASS   : TestQString::initTestCase()
PASS   : TestQString::toUpper()
PASS   : TestQString::cleanupTestCase()
Totals: 3 passed, 0 failed, 0 skipped
********* Finished testing of TestQString *********
~~~

Поздравляю, Вы только что выполнили свой первый unit-тест используя Qt фреймворк.

